



##启动vearch

cp vearch/config/config.toml.example config.toml
nohup docker run -p 8817:8817 -p 9001:9001 -v $PWD/config.toml:/vearch/config.toml vearch:fisher27v2 all &


##vearch官方文档
https://github.com/vearch/vearch/blob/master/docs/SourceCompileDeploymentZH_CN.md

-----------------
###建库建表（master）
建库：
curl -XPUT -H "content-type:application/json" -d '
{
"name":"test_vearch_db"
}
' http://127.0.0.1:8817/db/_create

建表：
curl -XPUT -H "content-type: application/json" -d '
{
"name":"space_testone",
"partition_num":1,
"replica_num":1,
"engine": {
"name":"gamma",
"index_size":50000,
"max_size":10000000,
"id_type":"String",
"retrieval_type":"IVFPQ",
"retrieval_param": {
"metric_type":"InnerProduct",
"ncentroids":256,
"nsubvector":16
}
},
"properties": {
"key": {
"type":"keyword"
},
"data": {
"type":"vector",
"dimension":128,
"store_type":"Mmap"
}
}
}
' http://127.0.0.1:8817/space/test_vearch_db/_create

###数据库及表结构查询：
curl -XGET http://127.0.0.1:8817/list/db
curl -XGET http://127.0.0.1:8817/space/test_vearch_db/space_testone
curl -XGET http://127.0.0.1:8817/list/space?db=test_vearch_db
-----------------------
###数据操作（crud，router）

####单条插入：
curl -H "content-type: application/json" -XPOST -d'
{"data":{"feature":[0.0688087645208666, 0.008443916865264505, -0.01437951387617794, -0.03418667116435803, -0.10485069921833554, -0.029845898510935488, -0.03512012676616, 0.0905780782320615, -0.07735893003385892, 0.016460438909917482, -0.068785161311938, 0.057312416822865066, 0.0496299257946172, -0.026284995264791413, 0.059103860471737664, 0.041926770556040424, 0.11964125670662086, 0.04711394915050982, 0.16381646381406637, 0.012430584372176251, 0.05982524637244863, 0.030385268893132034, -0.12123521447286606, -0.00905761312523878, 0.028108539847932712, 0.03875465321000923, -0.17822210655655343, 0.02500431023386219, 0.05101701910850372, -0.10668707448304539, 0.11944658154428375, 0.00238089530837131, 0.014481743136878071, 0.08612082317245054, -0.049801391134841194, 0.17887044223600787, 0.006416717638128482, -0.09236991526774957, 0.10640458854198409, -0.003116547182401493, -0.037041675977678705, -0.11078329166618005, 0.07105454143532357, -0.04087289582926618, 0.21077022471306253, -0.08653694090435174, 0.14469214051868054, 0.06712269152595975, -0.02354553642600057, 0.026267677693023152, 0.030418963329066323, 0.19242592475892645, 0.11753540577205142, 0.05006709827303369, -0.08555292084361556, 0.19238473886972352, 0.17529520602676077, -0.03434513478526762, -0.016978278490539435, 0.014494308709940538, -0.044194602787825964, -0.04114001402886202, -0.12576927688288425, -0.0642057453929761, 0.025803110668978193, 0.029305538960442055, -0.05111475007648775, 0.03213873646116566, 0.08864843038327636, 0.05608185725398902, 0.10239556640168854, 0.06807389514452372, 0.10264836019006865, 0.0039852079848137455, -0.055840694032327345, 0.10800130571719582, 0.0658214819655274, -0.00025188158706886403, 0.00750592306193907, -0.09775251874000876, -0.07233676580596553, 0.0807495880090328, 0.03433646602218165, 0.022637564023017094, 0.0005815710953582423, -0.0012552100276693847, 0.03858897179622438, -0.029515710142554018, 0.10757393940287527, 0.06789585055234233, 0.12433047315716626, 0.013874067405558046, -0.0789689710494731, -0.1378135497010044, -0.02616473292441951, 0.10770176161161416, 0.14417962021195482, 0.04000968542968865, 0.015215460859065496, 0.03244299550727485, 0.014039821510384888, 0.02819840593023631, 0.11945495099131447, -0.2196435717481143, 0.15008564479660919, -0.02706117025675932, -0.16487468575021455, 0.04278327912660937, -0.12189799714058741, 0.02409842306606365, 0.10468986672464581, -0.04481249944977563, 3.083810557844014e-05, 0.054440618953530105, 0.082981476658526, 0.05470894867049244, -0.2030391589649906, 0.0864731609289208, 0.0197740728868727, -0.0036882693542273346, -0.1605156861743416, 0.06412361876867265, -0.1900302788702893, -0.037043865260825704, 0.18482419775427336, 0.12699176347015573, -0.06572332340317873, -0.031755916927754174]},"key":"1"}
' http://127.0.0.1:9001/test_vearch_db/space_testone/1

####单条查询：
curl -XGET http://127.0.0.1:9001/test_vearch_db/space_testone/1



####向量相似查询：
curl -H "content-type: application/json" -XPOST -d'
{
"query": {
"sum":[
{
"field": "data",
"feature": [0.0688087645208666, 0.008443916865264505, -0.01437951387617794, -0.03418667116435803, -0.10485069921833554, -0.029845898510935488, -0.03512012676616, 0.0905780782320615, -0.07735893003385892, 0.016460438909917482, -0.068785161311938, 0.057312416822865066, 0.0496299257946172, -0.026284995264791413, 0.059103860471737664, 0.041926770556040424, 0.11964125670662086, 0.04711394915050982, 0.16381646381406637, 0.012430584372176251, 0.05982524637244863, 0.030385268893132034, -0.12123521447286606, -0.00905761312523878, 0.028108539847932712, 0.03875465321000923, -0.17822210655655343, 0.02500431023386219, 0.05101701910850372, -0.10668707448304539, 0.11944658154428375, 0.00238089530837131, 0.014481743136878071, 0.08612082317245054, -0.049801391134841194, 0.17887044223600787, 0.006416717638128482, -0.09236991526774957, 0.10640458854198409, -0.003116547182401493, -0.037041675977678705, -0.11078329166618005, 0.07105454143532357, -0.04087289582926618, 0.21077022471306253, -0.08653694090435174, 0.14469214051868054, 0.06712269152595975, -0.02354553642600057, 0.026267677693023152, 0.030418963329066323, 0.19242592475892645, 0.11753540577205142, 0.05006709827303369, -0.08555292084361556, 0.19238473886972352, 0.17529520602676077, -0.03434513478526762, -0.016978278490539435, 0.014494308709940538, -0.044194602787825964, -0.04114001402886202, -0.12576927688288425, -0.0642057453929761, 0.025803110668978193, 0.029305538960442055, -0.05111475007648775, 0.03213873646116566, 0.08864843038327636, 0.05608185725398902, 0.10239556640168854, 0.06807389514452372, 0.10264836019006865, 0.0039852079848137455, -0.055840694032327345, 0.10800130571719582, 0.0658214819655274, -0.00025188158706886403, 0.00750592306193907, -0.09775251874000876, -0.07233676580596553, 0.0807495880090328, 0.03433646602218165, 0.022637564023017094, 0.0005815710953582423, -0.0012552100276693847, 0.03858897179622438, -0.029515710142554018, 0.10757393940287527, 0.06789585055234233, 0.12433047315716626, 0.013874067405558046, -0.0789689710494731, -0.1378135497010044, -0.02616473292441951, 0.10770176161161416, 0.14417962021195482, 0.04000968542968865, 0.015215460859065496, 0.03244299550727485, 0.014039821510384888, 0.02819840593023631, 0.11945495099131447, -0.2196435717481143, 0.15008564479660919, -0.02706117025675932, -0.16487468575021455, 0.04278327912660937, -0.12189799714058741, 0.02409842306606365, 0.10468986672464581, -0.04481249944977563, 3.083810557844014e-05, 0.054440618953530105, 0.082981476658526, 0.05470894867049244, -0.2030391589649906, 0.0864731609289208, 0.0197740728868727, -0.0036882693542273346, -0.1605156861743416, 0.06412361876867265, -0.1900302788702893, -0.037043865260825704, 0.18482419775427336, 0.12699176347015573, -0.06572332340317873, -0.031755916927754174],
"boost":0.8
}
]
},
"retrieval_param": {
"parallel_on_queries": 1,
"recall_num" : 100,
"nprobe": 80,
"metric_type": "L2"
}
}
' http://127.0.0.1:9001/test_vearch_db/space_testone/_search
